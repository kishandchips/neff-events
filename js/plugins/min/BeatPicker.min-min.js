function BeatPicker(e){var t={};$.extend(!0,t,this,e),$.extend(this,t),this.constructor()}BeatPicker.prototype={dateInputNode:null,pickerNode:null,daysSimple:["Su","Mo","Tu","We","Th","Fr","Sa"],daysFull:[],monthsSimple:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],startDate:new Date,currentDate:new Date,dateFormat:{separator:"-",format:["YYYY","MM","DD"]},modules:{header:!0,footer:!0,daysOfTheWeek:!0,navBar:!0,today:!0,gotoDate:!0,icon:!0,clear:!0},selectionRule:{single:!0,range:!1,rangeDisableSelect:!1},className:{beatPicker:"beatpicker",header:"header",footer:"footer",days:"days",inputParent:"input-parent",headerNavBarParent:"header-navbar-container",headerNavBarButton:"header-navbar-button",weekDaysAliasCell:"week-alias-cell",weekDaysAliasCellParent:"week-alias-cell-parent",input:"beatpicker-input",inputTo:"beatpicker-input-to",betweenRange:"between-range",inputFrom:"beatpicker-input-from",daysCell:"days-cell",monthsCell:"months-cell",yearsCell:"years-cell",yearsRangeCell:"years-range-cell",daysCellParent:"days-cell-parent",todayButton:"today",todayBox:"today-box",gotoDateParent:"goto-date-parent",gotoDateInput:"goto-date",gotoDateButton:"goto-date-button",selected:"selected",disabled:"disabled",clear:"beatpicker-clear",_inner:{beatPicker:"beatpicker",inputContainer:"input-container",cell:"cell",cellM:"cell-months",cellY:"cell-years",cellYR:"cell-years-range",cellParent:"cell-parent",headerNavBar:"main-nav",headerNavBarBtn:"nav-btn",headerNavBarBtnNext:"next",headerNavBarBtnPrev:"prev",inputNode:"beatpicker-inputnode",dateInputTo:"beatpicker-inputnode-to",betweenDateNode:"between-range",dateInputFrom:"beatpicker-inputnode-from",headerNavBarBtnMonthIndicator:"current-indicator",notNotable:"not-notable",todayButton:"today",gotoDateInput:"date-input",gotoDateButton:"date-input-button",gotoDateContainer:"goto-date-container",footer:"footer",todayInGrid:"notable-today",selectedDate:"selected-date",disableDate:"date-disabled",clearButton:"beatpicker-clearButton",defaultButton:"button"}},view:{display:"days",alwaysVisible:!1,position:["bottom","left"],showOn:"click",hideOn:"click",isInputIsReadonly:!0,iconImage:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAANAA0DASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABgQF/8QAIxAAAQQBBAIDAQAAAAAAAAAAAQIDBBEFABIhQQYxExQiUf/EABQBAQAAAAAAAAAAAAAAAAAAAAX/xAAbEQACAgMBAAAAAAAAAAAAAAABIQAEFUFhMf/aAAwDAQACEQMRAD8Af5PxCZHiwYeRzUBuMwHPqoU0sJRdqXzVXwa9cCheqT4dl8zj4RXm4smIy3sjflwbU3yOe+K6raB1p/k8VFyTjJl/MoNhaQhLhSk7hRsD2a761lePSnV4dCo+1ptLzraUrtZoKuyomySSST/TpHK2EwuDfsOxddovp1P/2Q=="},labels:{today:"Today",gotoDateInput:"YYYY/MM/DD",gotoDateButton:"GO",clearButton:"Clear"},events:{select:"select",change:"change",show:"show",hide:"hide",clear:"clear"},disablingRules:[],_inputParentNode:null,_dateInputToNode:null,_dateRows:[],_monthsRows:[],_yearsRows:[],_yearsRangeRows:[],_monthUnit:"MM",_yearUnit:"YYYY",_dayUnit:"DD",_todayNode:null,_calendarMainNode:null,_selectedDateNode:null,_selectedDate:null,_startRangeSelectedDate:null,_startRangeSelectedDateBk:null,_startRangeSelectedNode:null,_endRangeSelectedDate:null,_endRangeSelectedDateBk:null,_endRangeSelectedNode:null,_isFromDateOpened:!1,_isToDateOpened:!1,_isHide:!0,_disableDateMap:[],_displaySet:{days:"days",months:"months",years:"years"},_briefDateScope:{briefDate:"BRIEFDATE",yearName:"YEARNAME",yearsRange:"YEARSRANGE"},_rulesCharacterSet:{"<":"<",">":">","*":"*"},_topicMap:{},constructor:function(){!window.beatPickerList&&(window.beatPickerList=[]),window.beatPickerList.push(this),this._enhanceLibFunctions(),this._setStartDate(this.startDate),this._disablingRuleEngine(),this._prepareInput();var e=this._calendarMainNode=this.pickerNode=this._baseDom();if(this._eventAndPositioning(),this.modules.header){var t=this._createHeader();e.prepend(t)}if(this.modules.navBar&&t&&e.append(this._createNavBar(t)),e.append(this._createDateMatrices()),this.modules.footer){var a=this._createFooter();e.append(a)}this.modules.footer&&this.modules.today&&this._createToday(a),this.modules.footer&&this.modules.gotoDate&&this._createGotoDate(a),this.modules.icon&&this._createIcon(),this.modules.clear&&this._createClear(),this._getDecisionOnEvents(),this.view.alwaysVisible&&this.show()},_setStartDate:function(e){"string"==typeof e?this.startDate=new Date(e):e instanceof Array?this.startDate=new Date(this.startDate[0],this.startDate[1]-1,this.startDate[2]):e instanceof Object&&(this.startDate=e),this.currentDate=this.startDate},_prepareInput:function(){this.dateInputNode.after(this._inputParentNode=this._domGenerator("div",{"class":this._addClass(this.className.inputParent,this.className._inner.inputContainer)})),this.dateInputNode.appendTo(this._inputParentNode).addClass(this._addClass(this.className.input,this.className._inner.inputNode)),this.selectionRule.range&&this.dateInputNode.addClass(this._addClass(this.className.inputFrom,this.className._inner.dateInputFrom)).after(this._dateInputToNode=this._domGenerator("input",{type:"text","class":this._addClass(this.className.inputTo,this.className._inner.dateInputTo,this.className.input,this.className._inner.inputNode)},this._inputParentNode)),this.view.isInputIsReadonly&&this.dateInputNode.add(this.selectionRule.range?this._dateInputToNode:{}).attr("readonly",!0)},_baseDom:function(){return this._domGenerator("div",{"class":this._addClass(this.className.beatPicker,this.className._inner.beatPicker)},this.view.alwaysVisible?this._inputParentNode:$("body"))},_createClear:function(){var e=this,t=this._domGenerator("button",{"class":this._addClass(this.className.clear,this.className._inner.clearButton,this.className._inner.defaultButton),type:"button"},null,this.labels.clearButton);t.on("click",function(){if(e._selectedDate||e._startRangeSelectedDate||e._endRangeSelectedDate){var t={timeStamp:(new Date).getTime()};e.selectionRule.range?$.extend(t,{startDate:e._startRangeSelectedDate,startDateString:e._startRangeSelectedDate?e._dateFormatting(e._startRangeSelectedDate):null,endDate:e._endRangeSelectedDate,endDateString:e._endRangeSelectedDate?e._dateFormatting(e._endRangeSelectedDate):null}):e.selectionRule.single&&$.extend(t,{date:e._selectedDate,string:e._dateFormatting(e._selectedDate)}),e._notifySubscribers(e.events.clear,t),e.reset()}}),this._inputParentNode.append(t)},_createIcon:function(){this.dateInputNode.add(this._dateInputToNode).css("background-image","url('"+this.view.iconImage+"')")},_createNavBar:function(e){var t=this,a=this._domGenerator("div",{"class":this._addClass(this.className.headerNavBarParent,this.className._inner.headerNavBar)},e,"",!0);this._domGenerator("a",{"class":this._addClass(this.className.headerNavBarButton,this.className._inner.headerNavBarBtn,this.className._inner.headerNavBarBtnNext,this.className._inner.defaultButton)},a,">").on("click",function(){t._increaseUnity(!1)});var s=this._currentIndicator=this._domGenerator("a",{"class":this._addClass(this.className.headerNavBarButton,this.className._inner.headerNavBarBtn,this.className._inner.headerNavBarBtnMonthIndicator,this.className._inner.defaultButton)},a).on("click",function(){t._ExpandOrCollapse(!0)});this._currentBriefDateSet(s,this._briefDateScope.briefDate),this._domGenerator("a",{"class":this._addClass(this.className.headerNavBarButton,this.className._inner.headerNavBarBtn,this.className._inner.headerNavBarBtnPrev,this.className._inner.defaultButton)},a,"<").on("click",function(e){t._increaseUnity(!0)})},_createHeader:function(){var e=this._domGenerator("div",{"class":this.className.header});return this.modules.daysOfTheWeek&&e.append(this._createDaysOfTheWeek(this.daysSimple)),e},_createDaysOfTheWeek:function(e){if(e instanceof Array){var t=this._weekDayParent=this._domGenerator("ul",{"class":this.className.weekDaysAliasCellParent+" "+this.className._inner.cellParent});return this.forEach(e,function(e,a){this._domGenerator("li",{"class":this.className.weekDaysAliasCell+" "+this.className._inner.cell},t,a)},this),t}},_createFooter:function(){return this._footerNode=this._domGenerator("div",{"class":this._addClass(this.className.footer,this.className._inner.footer)})},_createToday:function(e){var t=this;this._domGenerator("a",{"class":this._addClass(this.className.todayButton,this.className._inner.todayButton,this.className._inner.defaultButton)},e,this.labels.today).on("click",function(e){t.currentDate=new Date,t._updateDateMatricesExactDate(t.currentDate)})},_createGotoDate:function(e){var t=this,a=this._domGenerator("div",{"class":this._addClass(this.className.gotoDateParent,this.className._inner.gotoDateContainer)},e),s=this._domGenerator("input",{type:"text","class":this._addClass(this.className.gotoDateInput,this.className._inner.gotoDateInput),placeholder:this.labels.gotoDateInput},a).on("keydown",function(e){13===e.keyCode&&t._jumpToDateFromInput(s)});this._domGenerator("a",{type:"button","class":this._addClass(this.className.gotoDateButton,this.className._inner.gotoDateButton,this.className._inner.defaultButton)},a,this.labels.gotoDateButton).on("click",function(){t._jumpToDateFromInput(s)})},_createDateMatrices:function(){var e=this;if(this._notifySubscribers(this.events.change,{date:this.currentDate,timeStamp:(new Date).getTime()}),!this._daysBody)var t=this._daysBody=this._domGenerator("div",{"class":this.className.days});if(this._daysCellParent&&this._daysCellParent.empty(),this._dateRows.length=this._monthsRows.length=this._yearsRows.length=0,!this._daysCellParent)var a=this._daysCellParent=this._domGenerator("ul",{"class":this.className.daysCellParent+" "+this.className._inner.cellParent},this._daysBody);if(this.view.display===this._displaySet.days){this._weekDayParent&&this._weekDayParent.show(),this._daysBody.find(a).empty();for(var s=0;42>s;s++){var i=this._domGenerator("li",{"class":this.className.daysCell+" "+this.className._inner.cell},this._daysCellParent);this._dateRows.push(i);var n=this._bindDateToRows(s,i);i.data("click-behaviour",n.isNextMonth),i.on("click",function(t){var a=$(this).data("click-behaviour"),s=$(this).data("disabled");!s&&e._dateSelect(t),"not-avail"!==a&&e._updateDateMatrices(a?1:-1,e._monthUnit)}),i.text(n.day),this.selectionRule.single&&this._findSelectedDate(this._dateRows[s].data("date"),this._dateRows[s])}this._markToday(new Date),this.selectionRule.range&&this._addClassToRange(this._startRangeSelectedDate,this._endRangeSelectedDate)}else this.view.display===this._displaySet.months?(this._createMonths(),this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.yearName)):this.view.display===this._displaySet.years&&(this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.yearsRange),this._createYears());return t},_createMonths:function(){var e=this;this._weekDayParent&&this._weekDayParent.hide();for(var t=0;11>=t;t++){var a=this._domGenerator("li",{"class":this._addClass(this.className.monthsCell,this.className._inner.cell,this.className._inner.cellM)},this._daysCellParent,this.monthsSimple[t]).on("click",function(){e.view.display=e._displaySet.months,e._ExpandOrCollapse(!1,$(this).data("date"))});this._monthsRows.push(a),a.data("date",this._setAppropriateDate(t,!0))}},_createYears:function(){var e=this;this._weekDayParent&&this._weekDayParent.hide();for(var t=this._getYearsRange(this.currentDate.getFullYear()),a=0;11>=a;a++){var s=this._domGenerator("li",{"class":this._addClass(this.className.yearsCell,this.className._inner.cell,this.className._inner.cellY)},this._daysCellParent,t[a]).on("click",function(){e.view.display=e._displaySet.years,e._ExpandOrCollapse(!1,$(this).data("date"))});this._yearsRows.push(s),s.data("date",this._setAppropriateDate(t[a],!1))}},_updateMonths:function(){for(var e in this._monthsRows)this._monthsRows[e].data("date",this._setAppropriateDate(e,!0))},_updateYears:function(){var e=this._getYearsRange(this.currentDate.getFullYear());for(var t in this._yearsRows)this._yearsRows[t].data("date",this._setAppropriateDate(e[t],!1)),this._yearsRows[t].text("").text(e[t])},_eventAndPositioning:function(){var e=this;this.view.alwaysVisible||(e._calendarMainNode.css("display","none"),$("html,body").on(this.view.hideOn,function(t){!e._isHide&&e.hide()}),this._calendarMainNode.on("click",function(e){e.stopPropagation()}));var t=this.dateInputNode;this.selectionRule.range&&(t=this.dateInputNode.add(this._dateInputToNode)),t.on(this.view.showOn,function(t){if(t.stopPropagation(),e._isHide||e.selectionRule.range){var a=$.grep(window.beatPickerList,function(t,a){return t!==e&&!t.view.alwaysVisible});e.forEach(a,function(e,t){!t.isHide()&&t.hide()},e),e.show(t)}})},_positionThisNodePlease:function(e,t){var a=this._positionCalculation(e,t);this._calendarMainNode.css({left:a.x,top:a.y})},_positionCalculation:function(e,t){var a=this._dynamicsGeometry(e),s=t&&t.x||this.view.position[0],i=t&&t.y||this.view.position[1],n=this,r={rightTop:function(){s=this._rightCommon(),i=this._topCommon()-n._calendarMainNode.outerHeight()},rightMiddle:function(){s=this._rightCommon(),i=this._topCommon()-n._calendarMainNode.outerHeight()/2+n.dateInputNode.outerHeight()/2},rightBottom:function(){s=this._rightCommon(),i=this._topCommon()},leftTop:function(){s=this._leftCommon(),i=this._topCommon()-n._calendarMainNode.outerHeight()},leftMiddle:function(){s=this._leftCommon(),i=this._topCommon()-n._calendarMainNode.outerHeight()/2+n.dateInputNode.outerHeight()/2},leftBottom:function(){s=this._leftCommon(),i=this._topCommon()},bottomRight:function(){i=this._bottomCommon(),s=this._rightCommon()-n._calendarMainNode.outerWidth()},bottomMiddle:function(){i=this._bottomCommon(),s=this._leftCommon()+a.width/2+n._calendarMainNode.width()/2},bottomLeft:function(){i=this._bottomCommon(),s=this._leftCommon()+n._calendarMainNode.outerWidth()},topRight:function(){i=this._topCommon()-n._calendarMainNode.outerHeight(),s=this._rightCommon()-n._calendarMainNode.outerWidth()},topMiddle:function(){i=this._topCommon()-n._calendarMainNode.outerHeight(),s=this._leftCommon()+a.width/2+n._calendarMainNode.width()/2},topLeft:function(){i=this._topCommon()-n._calendarMainNode.outerHeight(),s=this._leftCommon()+n._calendarMainNode.outerWidth()},left:function(){s=this._leftCommon(),i=this._topAutoCommon()},top:function(){i=this._topCommon()-n._calendarMainNode.outerHeight(),s=this._leftAutoCommon()},right:function(){s=this._rightCommon(),i=this._topAutoCommon()},bottom:function(){i=this._bottomCommon(),s=this._leftAutoCommon()},"**":function(){i=this._topAutoCommon(),s=this._leftAutoCommon()},customAdjustment:function(){i=a.y+ +i,s=a.x+ +s},_rightCommon:function(){return a.x+a.width},_bottomCommon:function(){return a.y+a.height},_leftCommon:function(){return a.x-n._calendarMainNode.outerWidth()},_topCommon:function(){return a.y},_topAutoCommon:function(){var e;return+(this._topCommon()+n._calendarMainNode.outerHeight()-$(window).scrollTop())>$(window).height()?(e=$(window).height()+$(window).scrollTop()-n._calendarMainNode.outerHeight(),$(window).height()<n._calendarMainNode.outerHeight()&&(e=$(window).scrollTop())):e=this._topCommon(),Math.floor(e)},_leftAutoCommon:function(){var e,t=this._leftCommon()+n._calendarMainNode.outerWidth();return t+n._calendarMainNode.outerWidth()>$(window).width()?(e=$(window).width()-n._calendarMainNode.outerWidth(),0>=e&&(e=$(window).scrollLeft())):e=t,Math.floor(e)}};if(isNaN(s)&&isNaN(i)){var o=s,d=i.substr(0,1).toUpperCase()+this.view.position[1].substr(1),h="*"===s&&"*"===i?"**":"*"==i?o:o+d;"**"===h&&this.view.alwaysVisible&&(h="bottomLeft"),h in r&&r[h]()}else isNaN(s)||isNaN(i)||r.customAdjustment();return{y:i,x:s}},_dateSelect:function(e){var t=$(e.currentTarget||e.originalEvent.currentTarget),a=t.data("date"),s=this._dateFormatting(a),i={};this.selectionRule.single?(this._selectedDateNode&&this._removeClassFromSelectedDate(this._selectedDateNode),this._selectedDate=new Date(a.getTime()),this.dateInputNode.val(s),this._selectedDateNode=t,!this.view.alwaysVisible&&this.hide(),this._addClassToSelectedDate(this._selectedDateNode),i={dateObj:a,string:s,timeStamp:(new Date).getDate()},this._notifySubscribers(this.events.select,i)):this.selectionRule.range&&(this._isFromDateOpened?(this._startRangeSelectedDateBk=a,this._resetRules(!0)):this._isToDateOpened&&(this._endRangeSelectedDateBk=a,this._resetRules(!1)),this.selectionRule.rangeDisableSelect||!this._checkForRangeDisable(this._startRangeSelectedDateBk,this._endRangeSelectedDateBk,this._isFromDateOpened)?(i={fromDate:this._startRangeSelectedDate,toDate:this._endRangeSelectedDate,timeStamp:(new Date).getTime()},this._isFromDateOpened?(this._startRangeSelectedNode&&this._removeClassFromSelectedDate(this._startRangeSelectedNode),this._startRangeSelectedNode=t,this._startRangeSelectedDate=this._startRangeSelectedDateBk=a,$.extend(i,{fromDate:this._startRangeSelectedDate}),this._notifySubscribers(this.events.select,i),this.dateInputNode.val(s),this.show({currentTarget:this._dateInputToNode[0]})):this._isToDateOpened&&(this._endRangeSelectedNode&&this._removeClassFromSelectedDate(this._endRangeSelectedNode),this._endRangeSelectedNode=t,this._endRangeSelectedDate=this._endRangeSelectedDateBk=a,$.extend(i,{toDate:this._endRangeSelectedDate}),this._notifySubscribers(this.events.select,i),this._dateInputToNode.val(s),this._closeIfFill()&&!this._startRangeSelectedDate&&this.show(this.dateInputNode)),this._addClassToSelectedDate(t),this._startRangeSelectedDate&&this._endRangeSelectedDate&&this._addClassToRange(this._startRangeSelectedDate,this._endRangeSelectedDate)):(this._endRangeSelectedDateBk=this._endRangeSelectedDate?new Date(this._endRangeSelectedDate.getTime()):null,this._startRangeSelectedDateBk=this._startRangeSelectedDate?new Date(this._startRangeSelectedDate.getTime()):null))},_currentBriefDateSet:function(e,t){if(e)if(t===this._briefDateScope.briefDate)(e||this._currentIndicator).text(this.monthsFull[this.currentDate.getMonth()]+" "+this.currentDate.getFullYear());else if(t===this._briefDateScope.yearName)(e||this._currentIndicator).text(this.currentDate.getFullYear());else if(t===this._briefDateScope.yearsRange){var a=this._getYearsRange(this.currentDate.getFullYear());(e||this._currentIndicator).text(a[0]+"-"+a[a.length-1])}},_updateDateMatrices:function(e,t,a){var s={YYYY:"FullYear",MM:"Month",DD:"Date"},i=this.currentDate["get"+s[t]](),n=new Date(this.currentDate.getTime());31===this.currentDate.getDate()&&t===this._monthUnit&&this.currentDate.setDate(28),this.currentDate["set"+s[t]](i+e),this.currentDate.getFullYear()>=0?this._updateDateMatricesCommon(a):this.currentDate=new Date(n.getTime())},_updateDateMatricesExactDate:function(e,t,a){this.currentDate=new Date(e.getTime()),this._updateDateMatricesCommon(a)},_updateDateMatricesCommon:function(e){if(!e&&this._notifySubscribers(this.events.change,{date:this.currentDate,string:this._dateFormatting(this.currentDate),timeStamp:(new Date).getTime()}),this.view.display===this._displaySet.days){this._selectedDateNode&&this._removeClassFromSelectedDate(this._selectedDateNode),this.selectionRule.range&&(this._isFromDateOpened?this._endRangeSelectedDate&&this._disableDates(this._endRangeSelectedDate,!1):this._isToDateOpened&&this._startRangeSelectedDate&&this._disableDates(this._startRangeSelectedDate,!0));for(var t in this._dateRows){var a=this._bindDateToRows(+t,this._dateRows[t]);this._dateRows[t].data("click-behaviour",a.isNextMonth),$(this._dateRows[t]).text("").text(a.day),this.selectionRule.single&&this._findSelectedDate(this._dateRows[t].data("date"),this._dateRows[t])}this.selectionRule.range&&this._addClassToRange(this._startRangeSelectedDate,this._endRangeSelectedDate),this._markToday(new Date),this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.briefDate)}else this.view.display===this._displaySet.months?(this._updateMonths(),this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.yearName)):this.view.display===this._displaySet.years&&(this._updateYears(),this._currentBriefDateSet(this._currentIndicator,this._briefDateScope.yearsRange))},_markToday:function(e){if(this.modules.today){e=e||this.currentDate,this._todayNode&&this._todayNode.removeClass(this.className._inner.todayInGrid).removeClass(this.className.todayBox);for(var t in this._dateRows)this._dateEqualsTo(this._dateRows[t].data("date"),e)&&(this._todayNode=this._dateRows[t],$(this._dateRows[t]).addClass(this.className._inner.todayInGrid).addClass(this.className.todayBox))}},_findSelectedDate:function(e,t){this._selectedDate&&this._dateEqualsTo(e,this._selectedDate)&&(this._selectedDateNode=t,this._addClassToSelectedDate(t))},_bindDateToRows:function(e,t){var a=this,s=new Date(this.currentDate.getTime());t.removeClass(this.className._inner.notNotable);var i=this._numberOfDaysInMonth(s),n=this._currentDateExpose(s),r=!1;if(e>=n.firstDay&&e<i.nowMonthDays+n.firstDay)e=e-n.firstDay+1,r="not-avail",s.getDate()==e-1&&0==s.getHours()&&2==n.month?s=new Date(n.year,n.month,n.date+1,2):s.setDate(e);else if(e<n.firstDay){var o=i.prevMonthDays-(n.firstDay-e-1);s.setMonth(s.getMonth()-1),s.setDate(o),t.addClass(this.className._inner.notNotable),e=o}else if(e>=i.nowMonthDays+n.firstDay){var d=e+1-(n.firstDay+i.nowMonthDays);s.setMonth(s.getMonth()+1),s.setDate(d),t.addClass(this.className._inner.notNotable),r=!0,e=d}return t.data("date",s),this._checkDisabling(s,t),{day:e,isNextMonth:r}},_currentDateExpose:function(e){var t=new Date(e.getTime());return t.setDate(1),{firstDay:t.getDay(),date:e.getDate(),day:e.getDay(),month:e.getMonth(),year:e.getFullYear()}},_numberOfDaysInMonth:function(e){var t=e.getMonth(),a=e.getFullYear();return{prevMonthDays:this._getNumberOfDays(0>t-1?11:t-1,0>t-1?a-1:a),nowMonthDays:this._getNumberOfDays(t,a),nextMonthDays:this._getNumberOfDays(t+1>11?1:t,t+1>11?a+1:a)}},_getNumberOfDays:function e(t,a){return/8|3|5|10/.test(t)?30:1!=t?31:a%4==0&&a%100!=0||a%400==0?29:28},_dateFormatting:function(e){var t=e.getDate(),a=e.getMonth()+1,s=e.getFullYear(),i="NM"==this.dateFormat.format[0]||"NM"==this.dateFormat.format[1]||"NM"==this.dateFormat.format[2],n={DD:+t>=10||i?+t:"0"+t,MM:a>=10?a:"0"+a,YYYY:s,YY:String(s).substr(2),NM:this.monthsFull[+a-1]},r=this.dateFormat.separator,o="";return this.forEach(this.dateFormat.format,function(e,t){n[t]&&(o+=n[t]+(2>e?r:""))},this),o},_disableDates:function(e,t){var a=this._interpretRule(e,e);for(var s in this._dateRows){var i=this._dateRows[s],n=i.data("date");this._removeDisableClass(i),i.data("disabled",!1);var r=this._currentDateExpose(n);this[t?"_isLessThan":"_isBiggerThan"](r,a,!0)&&(this._addDisableClass(i),i.data("disabled",!0))}},_backToNormalDisableRule:function(){for(var e in this._dateRows){var t=this._dateRows[e].data("date");this._checkDisabling(t,this._dateRows[e])}},_resetRules:function(e){"BOTH"===e?(delete this._disableDateMap[this._lastIndexOfFromDate],delete this._disableDateMap[this._lastIndexOfToDate]):e?delete this._disableDateMap[this._lastIndexOfFromDate]:delete this._disableDateMap[this._lastIndexOfToDate]},_addRule:function(e,t,a){var s=this._interpretRule(e,t);if(s){this._resetRules(a),this._disableDateMap.unshift(s);var i=0;a?(0===this._lastIndexOfToDate&&(this._lastIndexOfToDate=1),this._lastIndexOfFromDate=i):(0===this._lastIndexOfFromDate&&(this._lastIndexOfFromDate=1),this._lastIndexOfToDate=i)}},_disablingRuleEngine:function(){for(var e in this.disablingRules){var t=this.disablingRules[e],a=t.from,s=t.to;if(isNaN(Date.parse(t.from))){if(!this._isInRuleCharset(a))return}else a=new Date(a);if(isNaN(Date.parse(t.to))){if(!s instanceof Array&&!s in this._rulesCharacterSet)return}else s=new Date(t.to);var i=this._interpretRule(t.from,t.to);i&&this._disableDateMap.push(i)}},_interpretRule:function(e,t){var a=!isNaN(Date.parse(e))||e instanceof Date,s=!isNaN(Date.parse(t))||t instanceof Date,i=this._isArray(e),n=this._isArray(t),r=this._isString(e),o=this._isString(t),d={fromDate:null,toDate:null,fromMonth:null,toMonth:null,fromYear:null,toYear:null},h,l;return a&&s?(h=this._currentDateExpose(new Date(e)),l=this._currentDateExpose(new Date(t))):(h=a?this._currentDateExpose(new Date(e)):this._giveMeRules(e),l=s?this._currentDateExpose(new Date(t)):this._giveMeRules(t)),d.fromDate=h.date,d.fromMonth=h.month,d.fromYear=h.year,d.toDate=l.date,d.toMonth=l.month,d.toYear=l.year,d},_giveMeRules:function(e){var t={};return e instanceof Array&&(t.date=e[2],t.month=isNaN(+e[1])?e[1]:+e[1]-1,t.year=e[0]),"string"==typeof e&&(t.date=t.month=t.year=e),t},_isInRuleCharset:function(e){if(!e instanceof Array)return!1;var t=!1;for(var a in e)e[a]in this._rulesCharacterSet&&(t=!0);return t},_isMatchToStringRule:function(e,t){var a=this,s={">":this._isBiggerThan,"<":this._isLessThan,"*":function(s,i){return a._isBiggerThan(e,t,!0)||"*"===t.fromYear?"*"===i.toYear?"*"===i.toMonth?"*"===i.toDate?!0:s.date==i.toDate:"*"===i.toDate?s.month==i.toMonth:s.month==i.toMonth&&s.date==i.toDate:"*"===i.toMonth?"*"===i.toDate?s.year==i.toYear:s.year==i.toYear&&s.date==i.toDate:"*"===i.toDate?s.year==i.toYear&&s.month==i.toMonth:s.year==i.toYear&&s.month==i.toMonth&&s.date==i.toDate:void 0}};for(var i in t){if(">"===t[i]||"<"===t[i])return s[t.toDate](e,t,!0);if("*"===t[i])return s[t[i]](e,t)}},_isMatchingToDisableRule:function(e){var t=this._currentDateExpose(e),a=!1;for(var s in this._disableDateMap){var i=this._disableDateMap[s];if(i&&(a=this._isInRuleCharset(i)?this._isMatchToStringRule(t,i):this._isBiggerThan(t,i,!0)&&this._isLessThan(t,i,!1)),a)return a}return a},_checkDisabling:function(e,t){this._isMatchingToDisableRule(e)?(t.data("disabled",!0),this._addDisableClass(t)):(t.data("disabled",!1),this._removeDisableClass(t))},_checkForRangeDisable:function(e,t,a){if(e&&t){var s=new Date(t.getTime()),i=new Date(e.getTime());a?s.setDate(s.getDate()-1):i.setDate(i.getDate()+1);var n=this._getRangeDates(i,s);for(var r in n)if(this._isMatchingToDisableRule(n[r]))return!0;return!1}return!1},_isBiggerThan:function(e,t,a){var s=a?"from":"to";return e.year>t[s+"Year"]?!0:e.year==t[s+"Year"]&&e.month>t[s+"Month"]?!0:e.date>=t[s+"Date"]&&t[s+"Year"]==e.year&&t[s+"Month"]==e.month},_isLessThan:function(e,t,a){var s=a?"from":"to";return e.year<t[s+"Year"]?!0:e.year==t[s+"Year"]&&e.month<t[s+"Month"]?!0:e.date<=t[s+"Date"]&&t[s+"Year"]==e.year&&t[s+"Month"]==e.month},_isEqual:function(e,t,a){var s=a?"from":"to";return e.date==t[s+"Date"]&&t[s+"Year"]==e.year&&t[s+"Month"]==e.month},_enhanceLibFunctions:function(){this.forEach=function(e,t,a){$.each(e,function(e,s){t.call(a?a:this,e,s)})}},_domGenerator:function(e,t,a,s,i){var n=$(-1===e.indexOf("<")?"<"+e+">":e);return n.attr(t)[n[0].value?"val":"text"](s)[a?i?"prependTo":"appendTo":"andSelf"](a?a:void 0)},_addClass:function(){var e="",t=arguments;return this.forEach(arguments,function(a,s){e+=s+(a!==t.length-1&&1!==t.length?" ":"")},this),e},_dynamicsGeometry:function(e){var t=$(window).outerHeight(),a=$(window).outerWidth(),s=$(e)[this.view.alwaysVisible?"position":"offset"]().top,i=$(e)[this.view.alwaysVisible?"position":"offset"]().left,n=$(e).outerHeight(),r=$(e).outerWidth();return{height:n,width:r,x:i,y:s,winHeight:t,winWidth:a}},_getDecisionOnEvents:function(){var e=this;this.on(this.events.hide,function(t){(e._selectedDate||e._startRangeSelectedDate)&&e._updateDateMatricesExactDate(e._selectedDate||e._startRangeSelectedDate,!0),e._markToday(new Date)})},_rangeStatesManager:function(e){this._isToDateOpened=!1,this._isFromDateOpened=!0,e&&e.currentTarget===this._dateInputToNode[0]?(this._isToDateOpened=!0,this._isFromDateOpened=!1,this._resetRules(!1),this._startRangeSelectedDate&&this._addRule(this._startRangeSelectedDate,"<",!0)):(delete this._disableDateMap[this._lastIndexOfFromDate],this._endRangeSelectedDate&&this._addRule(this._endRangeSelectedDate,">",!1)),this._backToNormalDisableRule(),this._positionThisNodePlease(e&&this.selectionRule.range&&e.currentTarget===this._dateInputToNode[0]?this._dateInputToNode[0]:this.dateInputNode)},_increaseUnity:function(e){this.view.display===this._displaySet.days?this._updateDateMatrices(e?-1:1,this._monthUnit):this.view.display===this._displaySet.months?this._updateDateMatrices(e?-1:1,this._yearUnit):this.view.display===this._displaySet.years&&this._updateDateMatrices(e?-12:12,this._yearUnit)},_setAppropriateDate:function(e,t){var a=new Date;return a.setMonth(t),t?(a.setFullYear(this.currentDate.getFullYear()),a.setMonth(e)):(a.setFullYear(e),a.setMonth(1)),a.setDate(1),a},_closeIfFill:function(){return this._dateInputToNode.val()&&this.dateInputNode.val()?(!this.view.alwaysVisible&&this.hide(),this.view.alwaysVisible):!0},_getYearsRange:function(e){var t=e/12,a=12*Math.floor(t)+1,s=[];s.push(a);for(var i=1;11>=i;i++)s.push(a+i);return s},_ExpandOrCollapse:function(e,t){var a=this,s={1:function(){a._currentBriefDateSet(a._currentIndicator,a._briefDateScope.briefDate),a.view.display=a._displaySet.days},2:function(){a._currentBriefDateSet(a._currentIndicator,a._briefDateScope.yearName),a.view.display=a._displaySet.months},3:function(){a._currentBriefDateSet(a._currentIndicator,a._briefDateScope.yearsRange),a.view.display=a._displaySet.years}},i={days:1,months:2,years:3,yearsRange:4},n=e?s[i[this.view.display]+1]:s[i[this.view.display]-1];n&&(this.currentDate=t?new Date(t.getTime()):this.currentDate,n(),this._createDateMatrices())},_jumpToDateFromInput:function(e){var t=e.val();if(t){var a=e.val().split("/"),s=new Date;1===a.length?(this.view.display=this._displaySet.years,s.setFullYear(a[0])):2===a.length?(this.view.display=this._displaySet.months,s.setFullYear(a[0]),s.setMonth(a[1])):3===a.length&&(this.view.display=this._displaySet.days,s.setFullYear(a[0]),s.setMonth(a[1]),s.setDate(a[2])),this.currentDate=new Date(s.getTime()),this._createDateMatrices(s)}},_dateEqualsTo:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},_getRangeDates:function(e,t){for(var a=[],s=e;t>=s;)a.push(new Date(s)),s=this._addDays(s,1);return a},_addDays:function(e,t){var a=new Date(e.valueOf());return a.setDate(a.getDate()+t),a},_addClassToSelectedDate:function(e){e.addClass(this.className.selected+" "+this.className._inner.selectedDate)},_removeClassFromSelectedDate:function(e){e.removeClass(this.className.selected+" "+this.className._inner.selectedDate)},_removeDisableClass:function(e){e.removeClass(this.className.disabled+" "+this.className._inner.disableDate)},_addDisableClass:function(e){e.addClass(this.className.disabled+" "+this.className._inner.disableDate)},_addClassToRange:function(e,t){if(e&&t)var a=this._interpretRule(e,t);for(var s in this._dateRows){var i=$(this._dateRows[s]),n=i.data("date");if(this._removeClassFromSelectedDate(i),e&&t){i.removeClass(this.className.betweenRange+" "+this.className._inner.betweenDateNode);var r=this._currentDateExpose(n);this._isEqual(r,a,!0)||this._isEqual(r,a,!1)?this._addClassToSelectedDate(i):this._isBiggerThan(r,a,!0)&&this._isLessThan(r,a,!1)&&i.addClass(this.className.betweenRange+" "+this.className._inner.betweenDateNode)}else e?this._dateEqualsTo(this._startRangeSelectedDate,n)&&this._addClassToSelectedDate(i):t&&this._dateEqualsTo(this._endRangeSelectedDate,n)&&this._addClassToSelectedDate(i)}},_removeClassFromRange:function(){for(var e in this._dateRows)this._dateRows[e].removeClass(this.className.betweenRange+" "+this.className._inner.betweenDateNode)},_notifySubscribers:function(e,t){var a=this._topicMap[e];a&&this.forEach(a,function(e,a){a.func.call(a.scope,t)},this)},_isDate:function(e){return e instanceof Date},_isArray:function(e){return e instanceof Array},_isString:function(e){return"string"==typeof e},on:function(e,t,a){e&&"string"==typeof e&&t&&(!this._topicMap[e]&&(this._topicMap[e]=[]),
this._topicMap[e].push({func:t,scope:a?a:this._calendarMainNode}))},show:function(e){this._calendarMainNode.css("display",""),this._isHide=!1,!this.view.alwaysVisible&&this._notifySubscribers(this.events.show),this.selectionRule.range?this._rangeStatesManager(e):this._positionThisNodePlease(this.dateInputNode)},hide:function(){this._calendarMainNode.css("display","none"),this._isHide=!0,this._notifySubscribers(this.events.hide)},today:function(){this.currentDate=new Date,this._updateDateMatricesExactDate(self.currentDate)},reset:function(){this.selectionRule.range?((this._startRangeSelectedNode||this._endRangeSelectedNode)&&this._removeClassFromSelectedDate(this[this._startRangeSelectedNode?"_startRangeSelectedNode":"_endRangeSelectedNode"].add(this._endRangeSelectedNode)),this._resetRules("BOTH"),delete this._disableDateMap[this._lastIndexOfFromDate],delete this._disableDateMap[this._lastIndexOfToDate],this._endRangeSelectedDate=this._endRangeSelectedNode=this._startRangeSelectedDate=this._startRangeSelectedNode=this._lastIndexOfFromDate=this._lastIndexOfToDate=this._endRangeSelectedDateBk=this._startRangeSelectedDateBk=null,this._updateDateMatricesCommon(),this._removeClassFromRange()):(this._removeClassFromSelectedDate(this._selectedDateNode),this._selectedDateNode=this._selectedDate=null),this.dateInputNode.add(this._dateInputToNode).val("")},setDate:function(e){isNaN(Date.parse(e))||this._updateDateMatricesExactDate(this._isDate(e)?e:new Date(Date.parse(e)))},selectDate:function(e){if(!isNaN(Date.parse(e))){var t=this._isDate(e)?e:new Date(Date.parse(e));if(this._updateDateMatricesExactDate(t,null,!0),this._dateRows&&this._dateRows.length)for(var a in this._dateRows)if(this._dateEqualsTo(this._dateRows[a].data("date"),t))return this._dateRows[a].click()}},selectRangeOfDate:function(e,t){this.reset();var a=this._interpretRule(e,t);this._isBiggerThan(this._currentDateExpose(t),a,!0)&&(this._isFromDateOpened=!0,this._isToDateOpened=!1,this.selectDate(e),this._isFromDateOpened=!1,this._isToDateOpened=!0,this.selectDate(t),this.hide())},setPos:function(e,t){this._positionThisNodePlease(e,t)},isHide:function(){return this._isHide},isDisable:function(e){return isNaN(Date.parse(e))?e:this._isMatchingToDisableRule(new Date(Date.parse(e)))},getPickerNodes:function(){return this.dateInputNode.add(this._dateInputToNode)},getSelectedStartDate:function(){return this._startRangeSelectedDate},getSelectedEndDate:function(){return this._endRangeSelectedDate},getSelectedDate:function(){return this._selectedDate},getCurrentDate:function(){return this.currentDate}};var beatPickerIncrementalId=0;initializeBitCal=function(){var e=$("*").filter(function(){return $(this).data("beatpicker")});$(e).each(function(){var e=$(this),t={dateInputNode:e};$.extend(!0,t,_interpretExtraOptions(e),_interpretPosition(e),_interpretDisableRules(e),_interpretRange(e),_interpretDateFormat(e),_interpretDisablingModule(e)),_initialization(e,t)})},_initialization=function(e,t){var a=e.data("beatpicker-id");a?window[a]=new BeatPicker(t):(a="beatpicker-"+beatPickerIncrementalId++,window[a]=new BeatPicker(t),e.attr("data-beatpicker-id",a))},_interpretDisableRules=function(e){var t=e.data("beatpicker-disable");if(!t)return{};var a=[];t=t.replace(/\s+/g,"");var s=t.split("}");s=s.filter(function(e){return""!==e});for(var i in s){var n=s[i]+="}";0===n.indexOf(",")&&(n=n.substr(1)),a.push(_parseJsonEngine(n,["from","to"]))}return{disablingRules:a}},_interpretPosition=function(e){var t=e.data("beatpicker-position");return t?{view:{position:_parseJsonEngine(t,[])}}:{}},_interpretRange=function(e){var t=e.data("beatpicker-range");if(void 0===t)return{};t=String(t);var a,s;t=t.replace(/\s+/g,"");var i=t.split(",");return a="true"===i[0],s="true"===i[1],{selectionRule:{range:a,rangeDisableSelect:s,single:!a}}},_interpretDateFormat=function(e){var t=e.data("beatpicker-format");if(!t)return{};t=t.replace(/\s+/g,"");var a=t.indexOf("]"),s=t.substr(0,a+1),i=t.substr(a+2,t.length);return{dateFormat:$.extend({format:_parseJsonEngine(s,[])},i?_parseJsonEngine("{"+i+"}",["separator"]):{separator:"-"})}},_interpretExtraOptions=function(e){var t=e.data("beatpicker-extra");return t&&window[t]?window[t]:null},_interpretDisablingModule=function(e){var t=e.data("beatpicker-module");if(t){var a;t=t.replace(/\s+/g,""),a=t.split(",");var s={modules:{}};for(var i in a){var n=a[i];s.modules[n]=!1}return s}},_parseJsonEngine=function(e,t){for(var a in t)e=e.replace(t[a],'"'+t[a]+'"');return"string"==typeof e?JSON.parse(e.replace(/'/g,'"')):e};try{$(document).ready(function(){initializeBitCal()})}catch(e){}